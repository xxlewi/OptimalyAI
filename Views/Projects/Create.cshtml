@model OptimalyAI.ViewModels.CreateProjectViewModel
@using OAI.Core.Entities.Projects
@{
    ViewData["Title"] = "Nový projekt";
}

<div class="content-header">
    <div class="container-fluid">
        <div class="row mb-2">
            <div class="col-sm-6">
                <h1 class="m-0">Nový projekt</h1>
            </div>
            <div class="col-sm-6">
                <ol class="breadcrumb float-sm-right">
                    <li class="breadcrumb-item"><a asp-action="Index">Projekty</a></li>
                    <li class="breadcrumb-item active">Nový projekt</li>
                </ol>
            </div>
        </div>
    </div>
</div>

<section class="content">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-8 offset-md-2">
                <div class="card card-primary card-outline">
                    <div class="card-body">
                        <form asp-action="Create" method="post">
                            <div asp-validation-summary="ModelOnly" class="text-danger alert alert-danger"></div>
                            
                            <div class="form-group">
                                <label asp-for="Name" class="control-label">
                                    Název projektu <span class="text-danger">*</span>
                                </label>
                                <input asp-for="Name" class="form-control form-control-lg" placeholder="např. Redesign webových stránek" autofocus />
                                <span asp-validation-for="Name" class="text-danger"></span>
                            </div>
                            
                            <div class="form-group">
                                <label asp-for="Description" class="control-label">
                                    Co má projekt řešit? <span class="text-danger">*</span>
                                </label>
                                <textarea asp-for="Description" class="form-control" rows="5" placeholder="Popište co potřebujete udělat, jaký problém řešíte, co je cílem projektu..."></textarea>
                                <span asp-validation-for="Description" class="text-danger"></span>
                            </div>
                            
                            <div class="form-group">
                                <label asp-for="CustomerId" class="control-label">
                                    <i class="fas fa-user"></i> Pro koho je projekt?
                                </label>
                                <select asp-for="CustomerId" class="form-control">
                                    <option value="">Interní projekt (pro naši firmu)</option>
                                    @if (ViewBag.Customers != null)
                                    {
                                        <optgroup label="Zákazníci">
                                            @foreach (var customer in ViewBag.Customers)
                                            {
                                                @if (Model.CustomerId == customer.Id)
                                                {
                                                    <option value="@customer.Id" selected>@customer.Name</option>
                                                }
                                                else
                                                {
                                                    <option value="@customer.Id">@customer.Name</option>
                                                }
                                            }
                                        </optgroup>
                                    }
                                </select>
                                <span asp-validation-for="CustomerId" class="text-danger"></span>
                            </div>
                            
                            <!-- Hidden fields -->
                            <input asp-for="ProjectType" type="hidden" value="Standard" />
                            <input asp-for="Priority" type="hidden" value="Medium" />
                            @if (!string.IsNullOrEmpty(Model.CustomerName))
                            {
                                <input asp-for="CustomerName" type="hidden" />
                                <input asp-for="CustomerEmail" type="hidden" />
                            }
                            
                            <div class="form-group mt-4">
                                <button type="submit" class="btn btn-primary btn-lg">
                                    <i class="fas fa-plus-circle"></i> Vytvořit projekt
                                </button>
                                <a asp-action="Index" class="btn btn-outline-secondary btn-lg ml-2">
                                    Zrušit
                                </a>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}